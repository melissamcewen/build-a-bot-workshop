<!DOCTYPE html>
<html lang="en-US">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Write Your Story With Code | build-a-bot-workshop</title>
<meta property="og:title" content="Write Your Story With Code">
<meta property="og:locale" content="en_US">
<link rel="canonical" href="http://localhost:4000/write-code.html">
<meta property="og:url" content="http://localhost:4000/write-code.html">
<meta property="og:site_name" content="build-a-bot-workshop">
<script type="application/ld+json">
{"name":null,"description":null,"author":null,"@type":"WebPage","url":"http://localhost:4000/write-code.html","publisher":null,"image":null,"headline":"Write Your Story With Code","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/assets/css/style.css?v=578c183fada45bcfcf41abead3a6bebbdea2efa2">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">build-a-bot-workshop</h1>
      <h2 class="project-tagline"></h2>
      
        <a href="http://github.com/melissamcewen/build-a-bot-workshop" class="btn">View on GitHub</a>
      
      
    </section>

    <section class="main-content">
    <ul>
     

        
          
            
                    <li>
          <a href="/README.html">
           
            Build A Bot Workshop Intro   
           
          </a>
        </li>
            
          
        
          
            
                    <li>
          <a href="/bot-design.html">
           
            Design Your Bot   
           
          </a>
        </li>
            
          
        
          
            
                    <li>
          <a href="/create-app.html">
           
            Create Your First App   
           
          </a>
        </li>
            
          
        
          
            
                    <li>
          <a href="/write-code.html" class="active">
            <b>
            Write Your Story With Code   
            </b>
          </a>
        </li>
            
          
        
          
            
                    <li>
          <a href="/bot-tricks.html">
           
            Teach Your Bot Cool Tricks   
           
          </a>
        </li>
            
          
        
      </ul>



     <h1 id="step-4-write-your-story-with-code">Step 4: Write Your Story With Code</h1>

<h2 id="learn-about-javascript-data-types">Learn about Javascript Data Types</h2>
<p>Javascript can understand many different types of data, but you often need to tell it what kind of data you’re using. For example you can tell Javascript to do 4 + 4. Javascript can do math so you’d expect 8 right? But if you wrap the “4+4” in quotes Javascript will instead return “4+4”. If you wrap the fours themselves in strings like “4” + “4” Javascript will return “44”. That’s because the quotes tell Javascript your four is a “string”, which is like a word, rather than a number. Yeah, you’d understand if I asked you “4+4” but Javascript is just a computer language, so it sometimes doesn’t understand.</p>

<p>The reason this is important for our bots is that we need to send Facebook messages that it understands. Our writing can be seen as data as well. It needs to be the right type and also formatted correctly. The data types we’ll be using are: objects, arrays, and strings mainly.</p>

<p>We already learned about strings, but what about objects? You can think of objects as just a categorized list. For example you could make an object to organize a phone book. What kind of data would you put in a phone book? Can you think of an example entry?</p>

<p>So like</p>
<blockquote>
  <p>First name: Melissa</p>
</blockquote>

<blockquote>
  <p>Last name: McEwen</p>
</blockquote>

<blockquote>
  <p>Phone number : 555-555-555</p>
</blockquote>

<p>To turn that into something JS will understand, let’s create an object.</p>

<p>First we want to declare a variable, the variable stores our data. So we can just use the variable in other things rather than writing the data over and over again. You can store any data type in a variable. And you can name it most anything, except you cannot use spaces and certain other characters in JS.</p>

<p>So I’ll just name it Melissa. And to start an object all if have to do is use some “curly braces”.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">melissa</span> <span class="o">=</span> <span class="p">{}</span>

</code></pre></div></div>

<p>OK inside those curly braces I’ll put my data. Each piece of data has a “key” which tells me what the data is for. Like what kind of data is “McEwen”?</p>

<p>I can use any word I want for this- last name, surname but it is also a variable, it’s just like a variable inside the melissa variable, so I’ll need to write it as a variable. Then I use a colon and then I the data that is stored - so in this case “McEwen.” This is a piece of data and I’m going to use the string type since it’s a word. I might also want to use that type for “555-555-5555” because otherwise JS will think it’s 555 minus 555 minus 5555 and I want it to just leave it alone and not do math on it :)</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">phone</span> <span class="p">:</span> <span class="s2">"555-555-5555"</span><span class="p">,</span>
<span class="nx">firstname</span><span class="p">:</span> <span class="s2">"melissa"</span>
<span class="nx">lastname</span> <span class="p">:</span> <span class="s2">"mcewen"</span>

</code></pre></div></div>
<p>Now I’ll stick all that stuff into my Melissa variable</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">melissa</span> <span class="o">=</span> <span class="p">{</span>
 <span class="na">phone</span> <span class="p">:</span> <span class="s2">"555-555-5555"</span><span class="p">,</span>
 <span class="na">firstname</span><span class="p">:</span> <span class="s2">"melissa"</span><span class="p">,</span>
 <span class="na">lastname</span> <span class="p">:</span> <span class="s2">"mcewen"</span><span class="p">,</span>
<span class="p">}</span>

</code></pre></div></div>
<p>Tada! Now you have an object!</p>

<p>We’ll also use arrays. Arrays are like lists and they can also contain any data, but they do not have keys like objects do. Think of your favorite foods. We’ll turn them into an array.</p>

<p>Arrays use brackets like this and we’ll also put our new array in a variable</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">favFoods</span> <span class="o">=</span> <span class="p">[]</span>

</code></pre></div></div>

<p>Now we’ll add a bunch of foods in there, as many as we want, the only rule is we separate them by a comma. What kind of data should we format our foods as?</p>

<p>If you said strings you’re right!</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">favFoods</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"pizza"</span><span class="p">,</span> <span class="s2">"hot dogs"</span><span class="p">,</span> <span class="s2">"lettuce"</span><span class="p">]</span>

</code></pre></div></div>

<p>These lists can also go inside our object</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">melissa</span> <span class="o">=</span> <span class="p">{</span>
 <span class="na">phone</span> <span class="p">:</span> <span class="s2">"555-555-5555"</span><span class="p">,</span>
 <span class="na">firstname</span><span class="p">:</span> <span class="s2">"melissa"</span><span class="p">,</span>
 <span class="na">lastname</span> <span class="p">:</span> <span class="s2">"mcewen"</span><span class="p">,</span>
 <span class="na">favFoods</span> <span class="p">:</span> <span class="p">[</span><span class="s2">"pizza"</span><span class="p">,</span> <span class="s2">"hot dogs"</span><span class="p">,</span> <span class="s2">"lettuce"</span><span class="p">]</span>
<span class="p">}</span>

</code></pre></div></div>
<h2 id="learn-about-documentation">Learn About Documentation</h2>

<p>Most APIs have something called documentation, which tell you the correct way to use them. You can find Facebook Messenger’s <a href="https://developers.facebook.com/docs/messenger-platform/">here</a>. I’ll tell you a bit about how to use it, but feel free to browse around.</p>

<p>For now let’s take a look at <a href="https://developers.facebook.com/docs/messenger-platform/send-messages/template/button">Button Template</a>. The Button Template is one of several different message templates available for Facebook chatbot messages. You saw it used in our test messages. If you scroll down you’ll see what you need to send to the API to create one. Take a look at it. While it might look a bit complicated, it’s made up of what we just saw before. What data types do you see?</p>

<p><img src="/assets/images/button-template.jpg" alt="an example API request for a button template"></p>

<p><img class="emoji" title=":tada:" alt=":tada:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png" height="20" width="20"> <strong>Activity</strong> <img class="emoji" title=":tada:" alt=":tada:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png" height="20" width="20">
Discuss what the three highlighted parts might mean and what data structures they contain. Now look at the following example then see if you can see what parts of the example message might go with each part.</p>

<p><img src="/assets/images/send-greeting-puzzle.jpg" alt="what parts of this correspond to the messsage">
<img src="/assets/images/send-greeting-puzzle-2.jpg" alt="what parts of this correspond to the messsage"></p>

<h2 id="learn-about-functions">Learn About Functions</h2>
<p>In the previous activity you figured out how a message was formatted with data structures. But you also looked at our first function. A function takes arguments, a type of input, and does things with this. In this case, it took a variable called recipientId as an argument, and took the message and sent it to that recipient. A function can have any name similar to the names allowed for variables.</p>

<p>What a function is called it looks like this:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">functionName</span><span class="p">(</span><span class="nx">argument</span><span class="p">)</span>
</code></pre></div></div>
<p>The function we looked at called another functon</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nx">API</span><span class="p">.</span><span class="nx">callSendAPI</span><span class="p">(</span><span class="nx">messageData</span><span class="p">);</span>
</code></pre></div></div>
<p>Head over to api.js in your Glitch app and take a look at that function. What does it take as an input? What do you think it does?</p>

<p>We also saw that the buttons were an array, that contained a reference to something called a “postback.” A postback is just what the button should do when it is pressed, when the button is pressed it has a “payload” which is basically the name of the action triggered. Let’s head to actions.js and look at a function there called receivedPostback. What do you think this does?</p>

<h3 id="tada-activity-tada">
<img class="emoji" title=":tada:" alt=":tada:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png" height="20" width="20"> <strong>Activity</strong> <img class="emoji" title=":tada:" alt=":tada:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png" height="20" width="20">
</h3>
<p>We’re going to practice writing some functions using a site called <a href="http://jsbin.com/zuseqe/edit?js,console">jsbin</a>. See if you can get the myFunction to run and get you the secret code word. Then see if you can write your own function.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// example function</span>
<span class="kd">function</span> <span class="nx">exampleAdd</span><span class="p">(</span><span class="nx">number1</span><span class="p">,</span> <span class="nx">number2</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// console.log just logs the output of our function to the console over here -&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello console"</span><span class="p">)</span>
  <span class="c1">// now we'll add the two  numbers</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">number1</span> <span class="o">+</span> <span class="nx">number2</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// call the example function</span>
<span class="nx">exampleAdd</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="c1">// declaring a function</span>
<span class="kd">function</span> <span class="nx">myFunction</span><span class="p">(</span><span class="nx">argument</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//let's store our answer in a variable</span>
  <span class="kd">var</span> <span class="nx">answer</span> <span class="o">=</span> <span class="p">(</span><span class="nx">argument</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">42</span><span class="p">;</span>
  <span class="c1">//now console.log the answer</span>
  <span class="c1">// to combine words we taking strings and using + to put them together</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"look for line "</span> <span class="o">+</span> <span class="nx">answer</span> <span class="o">+</span> <span class="s2">" in messages.js for the answer"</span><span class="p">);</span>
  
<span class="p">}</span>

<span class="c1">// call your function with the number 32 as the argument</span>

<span class="c1">// now look in messages.js for the secret code word</span>

<span class="c1">// Now let's write your own function to take your first and last name as arguments </span>
<span class="c1">// and log your full name to the console</span>

</code></pre></div></div>

<p>Now take a look at the receivedPostback function in your actions.js file. You’re going to see something very important in Javascript. That’s the if statement. It looks like this</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">if</span> <span class="p">(</span><span class="nx">payload</span> <span class="o">===</span> <span class="s2">"get_started"</span><span class="p">){</span>
      <span class="nx">Messages</span><span class="p">.</span><span class="nx">sendGreeting</span><span class="p">(</span><span class="nx">senderID</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>Basically what it is doing is saying if the button pressed had the action “get_started” then we do the function in the curly braces {}. What if it’s not? Well look at the next if statement. What’s that looking for? What do you think we need to do to make all our actions work?</p>

<h3 id="tada-activity-tada-1">
<img class="emoji" title=":tada:" alt=":tada:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png" height="20" width="20"> <strong>Activity</strong> <img class="emoji" title=":tada:" alt=":tada:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png" height="20" width="20">
</h3>
<p>Check out lines 19-53 in your actions.js, see if you can get your chatbot to respond with the 4 secret messages coded in this code.</p>

<h2 id="add-your-story-to-a-function">Add Your Story To A Function</h2>

<h3 id="tada-activity-tada-2">
<img class="emoji" title=":tada:" alt=":tada:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png" height="20" width="20"> <strong>Activity</strong> <img class="emoji" title=":tada:" alt=":tada:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png" height="20" width="20">
</h3>
<p>Think of action names for your questions that describe them but are simple lowercase words that are easy to code in, put them on <em>yellow</em> <img class="emoji" title=":yellow_heart:" alt=":yellow_heart:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f49b.png" height="20" width="20"> notecards next to their corresponding question (the <img class="emoji" title=":green_heart:" alt=":green_heart:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f49a.png" height="20" width="20"> <em>green</em> cards). 
<img src="/assets/images/cards-story2.jpg" alt="adding our variable cards"></p>

<p>The example actions here are:</p>
<ul>
  <li>get_started</li>
  <li>goodbye</li>
  <li>life</li>
  <li>dislikes</li>
  <li>town</li>
  <li>family</li>
  <li>books</li>
  <li>dreams</li>
  <li>likes</li>
</ul>

<p>Now we’ll add them to our postback function, so that each time a button corresponding to the yellow cards we just created is pressed, the correct message and following buttons are presented:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// if our payload/action is "get_started", send them a message with the following buttons</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">payload</span> <span class="o">===</span> <span class="s2">"get_started"</span><span class="p">){</span>
     <span class="kd">var</span> <span class="nx">messageText</span><span class="o">=</span> <span class="s2">"Oh hello! Sorry I didn't notice you, I've been reading this wonderful book. It's my favorite part because—you'll see Here's where she meets Prince Charming But she won't discover that it's him 'til Chapter Three!"</span><span class="p">;</span>
     <span class="kd">var</span> <span class="nx">buttons</span> <span class="o">=</span> <span class="p">[</span>
     <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span><span class="s2">"postback"</span><span class="p">,</span>
      <span class="na">payload</span><span class="p">:</span><span class="s2">"likes"</span><span class="p">,</span>
      <span class="na">title</span><span class="p">:</span><span class="s2">"Your likes"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span><span class="s2">"postback"</span><span class="p">,</span>
      <span class="na">payload</span><span class="p">:</span> <span class="s2">"life"</span><span class="p">,</span>
      <span class="na">title</span><span class="p">:</span> <span class="s2">"Your life"</span>
    <span class="p">}</span>
    
    <span class="p">];</span>
    <span class="nx">Messages</span><span class="p">.</span><span class="nx">sendButtons</span><span class="p">(</span><span class="nx">senderID</span><span class="p">,</span> <span class="nx">messageText</span><span class="p">,</span> <span class="nx">buttons</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>The function should refer to the following green cards below it in the outline, or if there are no more left, to the goodbye message</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">if</span> <span class="p">(</span><span class="nx">payload</span> <span class="o">===</span> <span class="s2">"dislikes"</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">messageText</span> <span class="o">=</span> <span class="s2">"Well there is this man in town named Gaston. Boorish, brainless. He thinks I would want to be his wife. Can you imagine?"</span>
    <span class="kd">var</span> <span class="nx">buttons</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span><span class="s2">"postback"</span><span class="p">,</span>
      <span class="na">payload</span><span class="p">:</span><span class="s2">"goodbye"</span><span class="p">,</span>
      <span class="na">title</span><span class="p">:</span><span class="s2">"Goodbye"</span>
    <span class="p">}</span>

    <span class="p">];</span>
    
    <span class="nx">Messages</span><span class="p">.</span><span class="nx">sendButtons</span><span class="p">(</span><span class="nx">senderID</span><span class="p">,</span> <span class="nx">messageText</span><span class="p">,</span> <span class="nx">buttons</span><span class="p">);</span>

  <span class="p">}</span>
  
</code></pre></div></div>

<p>These are already coded into the example app, you can simply change the wording. If you need more of them, you can copy and paste. Once you’ve finished it’s time to test your bot out. Does it work?</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code></code></pre></div></div>


     <div>

      
        
          
          
        
          
          
        
          
          
        
          
            
                <a href="http://localhost:4000/create-app.html">←Create Your First App</a> |
            
            
                  

                | <a href="http://localhost:4000/bot-tricks.html"> Teach Your Bot Cool Tricks→</a>
            
          
          
        
          
          
        
    </div>

      <footer class="site-footer">
        
          <span class="site-footer-owner"><a href="http://github.com/melissamcewen/build-a-bot-workshop">build-a-bot-workshop</a> is maintained by <a href="http://github.com/melissamcewen">melissamcewen</a>.</span>
        
        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
      </footer>
    </section>

    
  </body>
</html>
